(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"4Fm+":function(t,e,n){"use strict";n.r(e),n.d(e,"app",(function(){return g})),n.d(e,"win",(function(){return G}));var i=n("U8pU"),r=(n("QWBl"),n("FZtP"),n("2B1R"),n("brp2"),n("DQNa"),n("GKVU"),n("fbCW"),n("ToJy"),n("+2oP"),n("ma9I"),n("tkto"),n("eqqe"));n("wLYn");function o(t){var e=Math.floor(t/1e3/60);t-=1e3*e*60;var n=Math.floor(t/1e3);return((e+"").length<2?"0"+e:e)+":"+((n+"").length<2?"0"+n:n)}function a(t,e,n){return Math.floor(120-120*function(t,e,n){return 0==t&&0==e?0:(n-t)/(e-t)*100}(t,e,n)/100)}function s(t,e,n){var i,r,o,a,s,l,h,c;if(t=Math.max(0,Math.min(360,t)),e=Math.max(0,Math.min(100,e)),n=Math.max(0,Math.min(100,n)),n/=100,0==(e/=100))return[i=r=o=n,r,o];switch(l=n*(1-e),h=n*(1-e*(s=(t/=60)-(a=Math.floor(t)))),c=n*(1-e*(1-s)),a){case 0:i=n,r=c,o=l;break;case 1:i=h,r=n,o=l;break;case 2:i=l,r=n,o=c;break;case 3:i=l,r=h,o=n;break;case 4:i=c,r=l,o=n;break;default:i=n,r=l,o=h}return[i,r,o]}function l(t){for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e}var h=n("1OyB"),c=n("vuIU"),u=n("rePB"),f=(n("sMBO"),function(){function t(e,n,i){Object(h.a)(this,t),this.group=e,this.set=n,this.token=i,this.id=n+i,this.texturePath="/tiles/"+n+i+".png"}return Object(c.a)(t,null,[{key:"GetAll",value:function(){var e=[];return t.groups.forEach((function(n){n.sets.forEach((function(i){i.tokens.forEach((function(r){e.push(new t(n.name,i.name,r))}))}))})),e}},{key:"GetDeck",value:function(){var e=[],n=1;return t.GetAll().forEach((function(t){var i=4;"bonus"==t.group&&(i=1);for(var r=0;r<i;r++){var o=Object.assign({},t);o.uid=n++,e.push(o)}})),e}},{key:"GetTextures",value:function(){return t.GetAll().map((function(t){return t.texturePath}))}}]),t}());Object(u.a)(f,"groups",[{name:"suits",sets:[{name:"dot",tokens:["1","2","3","4","5","6","7","8","9"]},{name:"bamboo",tokens:["1","2","3","4","5","6","7","8","9"]},{name:"character",tokens:["1","2","3","4","5","6","7","8","9"]}]},{name:"honors",sets:[{name:"winds",tokens:["east","south","west","north"]},{name:"dragons",tokens:["red","green","white"]}]}]);var d=function(){function t(e,n,i,r,o){Object(h.a)(this,t),this.width=e,this.cols=n+2,this.ratio=i,this.slotWidth=e/this.cols-r,this.slotHeight=this.slotWidth*this.ratio,this.margin=r,this.slots=[],this.maxDistance=0,this.top=o}return Object(c.a)(t,[{key:"Clear",value:function(){this.slots=[]}},{key:"AddRange",value:function(t){for(var e=0;e<t.length/this.cols+2;e++){this.slots[e]=[];for(var n=0;n<this.cols;n++){var i=this.slotWidth*n+this.margin*n,r=this.slotHeight*e+this.margin*e+this.top;this.slots[e][n]={col:n,row:e,topLeft:{x:i,y:r},center:{x:i+this.slotWidth/2,y:r+this.slotHeight/2},item:null}}}for(var o=0;o<t.length/this.cols;o++)for(var a=0;a<this.cols-2;a++)this.slots[o+1][a+1].item=t[o*(this.cols-2)+a];this.maxDistance=this.cols+this.slots.length}}]),t}(),v=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,t);var o=32,a=16;this.label=e,this.callback=n,this.toggle=i,this.state=!1,this.text=new r.e(e,{fill:16119285,fontSize:32}),this.width=this.text.width+2*o,this.height=this.text.height+2*a,this.text.x=o,this.text.y=a,this.rect=new r.c,this.DrawRect(),this.rect.interactive=!0,this.rect.buttonMode=!0;var s=this;this.rect.on("pointerdown",(function(){s.state=!s.state,s.DrawRect(),n(s)})),this.container=new r.b,this.container.addChild(this.rect),this.container.addChild(this.text)}return Object(c.a)(t,[{key:"DrawRect",value:function(){this.rect.clear(),this.rect.lineStyle(4,2697513,1),this.rect.beginFill(this.BgColor()),this.rect.drawRoundedRect(0,0,this.width,this.height,10)}},{key:"BgColor",value:function(){return this.toggle&&!this.state?1315860:2697513}}]),t}(),g=new r.a({width:1920,height:1420,antialias:!0,backgroundAlpha:0,resolution:1});g.ticker.maxFPS=60;var m=!1,p=[],x=[],y=new d(g.renderer.view.width,17,1.33,8,100),w=[];w.push(new v("New",B)),w.push(new v("Check",(function(){if(0==C)return z("The game is over because you won!");null==H()?z("Game over :("):z("At least one move is possible")}))),w.push(new v("Hint",(function(){var t=H();if(null==t)return;j=null,F(t.a.item)}))),w.push(new v("Cheat",(function(){var t=H();if(null==t)return;j=null,F(t.a.item),F(t.b.item)}))),w.push(new v("Debug",(function(t){(m=t.state)?function(){for(var t={graphics:[],container:new r.b},e=0;e<y.slots.length;e++){t.graphics[e]=[];for(var n=0;n<y.slots[e].length;n++){t.graphics[e][n]={rect:new r.c,text:new r.e("",{fill:"#141414",fontSize:32})};var i=t.graphics[e][n];i.text.x=y.slots[e][n].topLeft.x+6,i.text.y=y.slots[e][n].topLeft.y,t.container.addChild(i.rect),t.container.addChild(i.text)}}g.stage.addChild(t.container),I=t}():(g.stage.removeChild(I.container),I=null)}),!0));var b=new r.b,k=0;w.forEach((function(t){t.container.x=k,k+=t.width+20,b.addChild(t.container)})),b.x=y.slotWidth+y.margin,b.y=y.top-b.height,g.stage.addChild(b);var C=0,M=new r.e("--- tiles left",{fill:16119285,fontSize:38,fontFamily:"monospace"});M.x=y.width-y.slotWidth-2*y.margin-M.width,M.y=y.top-1.25*M.height,g.stage.addChild(M);var D=0,L=new r.e(o(D),{fill:16119285,fontSize:38,fontFamily:"monospace"});L.x=M.x-256,L.y=M.y,g.stage.addChild(L);var O=f.GetDeck(),S=[],j=null,E=N(),R=N(),T=new r.c;g.stage.addChild(T);var A=[],W=null;function B(){$("message"),$("cleanSelect"),$("showerStop"),y.Clear(),y.AddRange(function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}return t}(O.map((function(t){return t.uid})))),_(),l(y.slots).forEach((function(t){if(null!=t.item){S[t.item].slot=t;var e=S[t.item].sprite;e.x=t.topLeft.x,e.y=t.topLeft.y,e.visible=!0,g.stage.addChild(e)}})),D=Date.now(),L.text=o(0),q("timeScore",1e3,(function(){L.text=o(Date.now()-D)}))}function F(t){var e,n=S[t];if($("cleanSelect"),null==j)E.position.set(n.slot.topLeft.x,n.slot.topLeft.y),E.visible=!0,j=t;else{var i=S[j];if(i.tile.uid!=n.tile.uid&&i.tile.id==n.tile.id){var r=P(i.slot,n.slot);r?(n.slot.item=null,i.slot.item=null,_(),E.position.set(i.slot.topLeft.x,i.slot.topLeft.y),E.visible=!0,R.position.set(n.slot.topLeft.x,n.slot.topLeft.y),R.visible=!0,e=r,T.clear(),T.lineStyle(8,16355671,1),T.moveTo(y.slots[e[0].y][e[0].x].center.x,y.slots[e[0].y][e[0].x].center.y),e.forEach((function(t){T.lineTo(y.slots[t.y][t.x].center.x,y.slots[t.y][t.x].center.y)})),T.visible=!0,A.push(n.sprite),A.push(i.sprite),J("cleanSelect",m?0:2e3,U)):U()}else U();j=null}}function G(){K("timeScore"),z("You won!",8e3);for(var t=[],e=0;e<O.length;e++){var n=O[e],i={sprite:S[n.uid].sprite,x:Math.random()*g.renderer.view.width,s:8*Math.random()+8,r:.08*Math.random()-.04};i.sprite.x=i.x,i.sprite.y=-1024,i.sprite.anchor.x=.5,i.sprite.anchor.y=.5,i.sprite.visible=!0,i.sprite.interactive=!1,t.push(i)}var r=Date.now();q("shower",1,(function(){var e=Date.now(),n=(e-r)/20;r=e;for(var i=0;i<t.length;i++){var o=t[i];o.sprite.y+=o.s*n,o.sprite.rotation+=o.r*n}})),J("showerStop",8e3,(function(){K("shower"),q("shower",1,(function(){for(var e=0;e<t.length;e++){var n=t[e];n.sprite.anchor.x=0,n.sprite.anchor.y=0,n.sprite.rotation=0,n.sprite.interactive=!0}}))}))}function H(){for(var t=l(y.slots),e=function(e){var n=t[e],i=t.find((function(t){return null!=t.item&&null!=n.item&&t.item!=n.item&&S[t.item].tile.id==S[n.item].tile.id&&P(n,t)}));if(void 0!==i)return{v:{a:n,b:i}}},n=0;n<t.length;n++){var r=e(n);if("object"===Object(i.a)(r))return r.v}return null}function P(t,e){var n={x:t.col,y:t.row},i={x:e.col,y:e.row},o=e.row-t.row,l=e.col-t.col,h=[{x:-1,y:0,d:-1*l},{x:1,y:0,d:l},{x:0,y:-1,d:-1*o},{x:0,y:1,d:o}];h=h.sort((function(t,e){return e.d-t.d}));for(var c=[],u=0;u<y.slots.length;u++){c[u]=[];for(var f=0;f<y.slots[u].length;f++)c[u][f]=u==n.y&&f==n.x||u==i.y&&f==i.x||null==y.slots[u][f].item?0:null}var d={a:n,b:i,d:[]};var v=function t(e,n,r){if(d.d.push({c:Object.assign({},e),m:c.map((function(t){return t.slice()}))}),e.x==i.x&&e.y==i.y)return n.concat(e);for(var o=n.length>0?n[n.length-1]:null,a=[],s=0;s<h.length;s++){var l={x:e.x+h[s].x,y:e.y+h[s].y};if(!(l.y<0||l.x<0||l.y>=c.length||l.x>=c[l.y].length)&&((null==o||o.x!=l.x||o.y!=l.y)&&null!=c[l.y][l.x])){var u=r;if(n.length>0&&(o.x==e.x&&e.x!=l.x||o.y==e.y&&e.y!=l.y)&&u--,!(u<0||0==u&&l.x!=i.x&&l.y!=i.y)){var f=Math.abs(i.x-l.x)+Math.abs(i.y-l.y)+1;if(!(u<=1&&f>e.v)&&(a.push({x:l.x,y:l.y,v:f,t:u}),c[l.y][l.x]=f,1==f))break}}}a.sort((function(t,e){return t.v-e.v}));for(var v=0;v<a.length;v++){var g=t(a[v],n.concat(e),a[v].t);if(null!=g)return g}return null}({x:n.x,y:n.y},[],2);return d.r=v,function(t){if(null==I)return;if(K("debugging"),!m)return;var e=0;q("debugging",50,(function(){e>=t.d.length?K("debugging"):(!function(t,e,n,i,o){if(null==I)return;for(var l=function(t){for(var e=t[0][0],n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)t[n][i]>e&&(e=t[n][i]);return e}(o),h=0;h<o.length;h++)for(var c=0;c<o[h].length;c++){var u=0;u=n.x==c&&n.y==h?16711935:t.x==c&&t.y==h||e.x==c&&e.y==h?65535:0==o[h][c]?16119285:r.f.rgb2hex(s(a(0,l,o[h][c]),100,100));var f=I.graphics[h][c];f.rect.clear(),f.rect.beginFill(u,null==o[h][c]?0:1),f.rect.drawRoundedRect(y.slots[h][c].topLeft.x,y.slots[h][c].topLeft.y,y.slotWidth,y.slotHeight,10),f.rect.endFill(),f.text.text=null==o[h][c]?"":"x: "+c+"\ny: "+h+"\nd: "+o[h][c]}}(t.a,t.b,t.d[e].c,t.d[e].e,t.d[e].m),e++)}))}(d),null!=v&&v}function _(){for(var t=0,e=0;e<y.slots.length;e++)for(var n=0;n<y.slots[e].length;n++){t+=null==y.slots[e][n].item?0:1}C=t,M.text=t+" tiles left"}function z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;$("message"),(W=new r.e(t,{fill:16119285,stroke:1315860,strokeThickness:8,fontSize:64})).x=g.renderer.view.width/2-W.width/2,W.y=g.renderer.view.height/2-W.height/2,g.stage.addChild(W),J("message",e,(function(){g.stage.removeChild(W)}))}function N(){var t=new r.c;return t.lineStyle(8,16355671),t.drawRoundedRect(0,0,y.slotWidth,y.slotHeight,10),t.visible=!1,g.stage.addChild(t),t}function U(){E.visible=!1,R.visible=!1,T.visible=!1,A.forEach((function(t){t.visible=!1})),A=[],0==C&&G()}g.loader.add(f.GetTextures()).load((function(){O.forEach((function(t){var e=new r.d(g.loader.resources[t.texturePath].texture);e.width=y.slotWidth,e.height=y.slotHeight,e.interactive=!0,e.buttonMode=!0,e.on("pointerdown",(function(){F(t.uid)})),S[t.uid]={tile:t,sprite:e,slot:null}})),B()}));var I=null;function J(t,e,n){p[t]={time:Date.now()+e,call:n}}function $(t){void 0!==p[t]&&(p[t].call(),function(t){if(void 0===p[t])return;delete p[t]}(t))}function q(t,e,n){x[t]={time:e,lastTime:Date.now(),call:n}}function K(t){void 0!==x[t]&&delete x[t]}g.ticker.add((function(t){var e=Date.now();Object.keys(p).forEach((function(t){var n=p[t];e>n.time&&$(t)})),Object.keys(x).forEach((function(t){var n=x[t];e>n.lastTime+n.time&&(n.lastTime=e,n.call())}))}))},"6p9A":function(t,e,n){"use strict";n.r(e);var i={components:{NavBar:n("0AAl").a}},r=n("KHd+"),o={components:{Layout:Object(r.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"layout"},[e("header",{staticClass:"header"},[e("NavBar")],1),this._t("default")],2)}),[],!1,null,null,null).exports},metaInfo:{title:"4Rivers"},mounted:function(){window.game=n("4Fm+"),this.$refs.game.appendChild(window.game.app.view)}},a=Object(r.a)(o,(function(){var t=this.$createElement,e=this._self._c||t;return e("Layout",[e("div",{staticClass:"container-xl pt-3 px-5"},[e("div",{ref:"game",attrs:{id:"game"}}),e("div",[e("h2",[this._v("How to play")]),e("p",[this._v("\n        A deck of 136 tiles is scrambled and placed into a grid of 17 by 8. The goal is to remove a pair of matching tiles till the grid is empty. They can be removed only if they can be connected by a uninterrupted line of maximum 3 segments (a line making 2 turns).\n      ")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);